{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "PAx Package Manifest",
  "type": "object",

  "utcs_header": {
    "id": "AAA-PAX-SCHEMA-PACKAGE",
    "project": "AMPEL360/AMPEL360_AIR_TRANSPORT/BWB-Q100",
    "artifact": "PRODUCTS/AMPEL360/AMPEL360_AIR_TRANSPORT/BWB-Q100/domains/AAA/pax/schemas/package.schema.json",
    "llc": "SYSTEMS",
    "classification": "INTERNAL–EVIDENCE-REQUIRED",
    "version": "1.0.0",
    "release_date": "2025-01-23",
    "maintainer": "ASI-T Avionics",
    "bridge": "CB→QB→UE→FE→FWD→QS",
    "ethics_guard": "MAL-EEM",
    "utcs_mi": "v5.0",
    "canonical_hash": "sha256:bbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbbb"
  },
  "utcs_signature": "signature-value-placeholder",
  "security_policy_id": "policy-001",

  "required": [
    "utcs_header",
    "package",
    "evidence",
    "package_name",
    "canonical_hash",
    "sbom_hash",
    "utcs_signature",
    "security_policy_id"
  ],
  "properties": {
    "package_name": {
      "type": "string",
      "description": "Unique package identifier"
    },
    "canonical_hash": {
      "type": "string",
      "pattern": "^sha256:[a-f0-9]{64}$",
      "description": "SHA256 hash of the canonical package content"
    },
    "sbom_hash": {
      "type": "string",
      "pattern": "^sha256:[a-f0-9]{64}$",
      "description": "SHA256 hash of the SBOM file"
    },
    "utcs_signature": {
      "type": "string",
      "description": "UTCS digital signature"
    },
    "security_policy_id": {
      "type": "string",
      "description": "Security policy identifier"
    },
    "utcs_header": {
      "type": "object",
      "required": [
        "id",
        "project",
        "artifact",
        "llc",
        "classification",
        "version",
        "release_date",
        "maintainer",
        "bridge",
        "ethics_guard",
        "utcs_mi",
        "canonical_hash"
      ],
      "properties": {
        "id": { "type": "string" },
        "project": { "type": "string" },
        "artifact": { "type": "string" },
        "llc": { "type": "string" },
        "classification": { "type": "string" },
        "version": { "type": "string" },
        "release_date": { "type": "string" },
        "maintainer": { "type": "string" },
        "bridge": { "type": "string" },
        "ethics_guard": { "type": "string" },
        "utcs_mi": { "type": "string" },
        "canonical_hash": { "type": "string" }
      }
    },
    "package": {
      "type": "object",
      "required": ["name", "kind", "target", "interfaces"],
      "properties": {
        "name": { "type": "string" },
        "kind": { "enum": ["OB-PARTITION", "OFF-OCI-IMAGE"] },
        "target": {
          "type": "object",
          "properties": {
            "platform": { "type": "string" },
            "os": { "type": "string" },
            "arch": { "type": "string" },
            "rtos": { "type": "string" },
            "arinc653": { "type": "object" },
            "oci": { "type": "object" }
          }
        },
        "resources": {
          "type": "object",
          "properties": {
            "cpu": { "type": "number" },
            "memory_mb": { "type": "number" },
            "storage_mb": { "type": "number" }
          }
        },
        "interfaces": {
          "type": "object",
          "properties": {
            "arinc653_ports": { "type": "array" },
            "a664_vlinks": { "type": "array" },
            "a429": { "type": "array" },
            "ipc": { "type": "array" },
            "network": { "type": "array" }
          }
        },
        "sbom": { "type": "string" },
        "dependencies": { "type": "array", "items": { "type": "string" } }
      }
    },
    "security": {
      "type": "object",
      "properties": {
        "signing": { "type": "object" },
        "constraints": { "type": "object" }
      }
    },
    "evidence": {
      "type": "object",
      "required": ["canonical_hash", "sbom", "signatures", "security_policy_id"],
      "properties": {
        "canonical_hash": {
          "type": "string",
          "pattern": "^sha256:[a-f0-9]{64}$"
        },
        "sbom": {
          "type": "object",
          "required": ["path", "hash"],
          "properties": {
            "path": { "type": "string" },
            "hash": { "type": "string", "pattern": "^sha256:[a-f0-9]{64}$" }
          }
        },
        "signatures": {
          "type": "array",
          "items": {
            "type": "object",
            "required": ["path", "type"],
            "properties": {
              "path": { "type": "string" },
              "type": { "enum": ["cosign", "in-toto", "x509"] },
              "keyid": { "type": "string" }
            }
          }
        },
        "security_policy_id": { "type": "string" },
        "qs_path": { "type": "string" },
        "attestations": { "type": "array", "items": { "type": "string" } },
        "notes": { "type": "string" }
      }
    }
  }
}
